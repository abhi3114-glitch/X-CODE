# X-code - AI-Powered Code Review Assistant

An intelligent GitHub-integrated bot that automatically reviews Pull Requests using Groq LLMs and static analysis tools. X-code provides inline comments with suggestions, detects anti-patterns, identifies security vulnerabilities, and offers auto-fix diffs for common issues.

## Features

- **Automatic PR Review**: Triggers on every PR open/update
- **Multi-Layer Analysis**:
  - Style checking with Pylint
  - Security scanning with Bandit
  - Complexity analysis with Radon
  - AI-powered insights with Groq (llama-3.3-70b-versatile)
- **Inline Comments**: Posts suggestions directly on code lines
- **Anti-Pattern Detection**: Identifies common code smells
- **Auto-Fix Suggestions**: Provides diff patches for simple issues
- **Comprehensive Reports**: Summary with severity breakdown
- **Cost-Effective**: Uses Groq API for affordable LLM inference

## Quick Start

### Prerequisites

- Python 3.8+
- GitHub account with repository access
- Groq API key (free tier available at https://console.groq.com)
- GitHub Personal Access Token

### Installation

1. **Clone the repository**
```bash
git clone https://github.com/abhi3114-glitch/X-CODE.git
cd X-CODE
```

2. **Install dependencies**
```bash
pip install -r requirements.txt
```

3. **Configure environment variables**
```bash
cp .env.example .env
```

Edit `.env` and add your credentials:
```env
GITHUB_TOKEN=your_github_personal_access_token
GITHUB_WEBHOOK_SECRET=your_webhook_secret
GROQ_API_KEY=your_groq_api_key
GROQ_MODEL=llama-3.3-70b-versatile
```

4. **Run the application**
```bash
python app.py
```

The server will start on `http://localhost:5000`

## GitHub Setup

### 1. Create Personal Access Token

1. Go to GitHub Settings → Developer settings → Personal access tokens
2. Generate new token (classic)
3. Select scopes:
   - `repo` (Full control of private repositories)
   - `write:discussion` (Read and write team discussions)
4. Copy the token to your `.env` file

### 2. Get Groq API Key

1. Visit https://console.groq.com
2. Sign up for a free account
3. Navigate to API Keys section
4. Create a new API key
5. Copy the key to your `.env` file

### 3. Configure Webhook

1. Go to your repository → Settings → Webhooks
2. Click "Add webhook"
3. Configure:
   - **Payload URL**: `https://your-domain.com/webhook`
   - **Content type**: `application/json`
   - **Secret**: Generate a random string and add to `.env`
   - **Events**: Select "Pull requests"
4. Save webhook

### 4. Expose Local Server (Development)

Use ngrok to expose your local server:
```bash
ngrok http 5000
```

Copy the HTTPS URL to your webhook configuration.

## Deployment

### Option 1: Heroku

1. **Install Heroku CLI**
```bash
curl https://cli-assets.heroku.com/install.sh | sh
```

2. **Create Heroku app**
```bash
heroku create xcode-review-bot
```

3. **Set environment variables**
```bash
heroku config:set GITHUB_TOKEN=your_token
heroku config:set GROQ_API_KEY=your_key
heroku config:set GITHUB_WEBHOOK_SECRET=your_secret
```

4. **Deploy**
```bash
git push heroku main
```

5. **Update webhook URL**
   - Use your Heroku app URL: `https://xcode-review-bot.herokuapp.com/webhook`

### Option 2: AWS EC2

1. **Launch EC2 instance** (Ubuntu 20.04)

2. **SSH into instance**
```bash
ssh -i your-key.pem ubuntu@your-ec2-ip
```

3. **Install dependencies**
```bash
sudo apt update
sudo apt install python3-pip nginx
```

4. **Clone and setup**
```bash
git clone https://github.com/abhi3114-glitch/X-CODE.git
cd X-CODE
pip3 install -r requirements.txt
```

5. **Configure environment**
```bash
nano .env
# Add your credentials
```

6. **Run with Gunicorn**
```bash
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

7. **Setup Nginx reverse proxy** (optional)

### Option 3: Docker

1. **Create Dockerfile**
```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

EXPOSE 5000
CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "app:app"]
```

2. **Build and run**
```bash
docker build -t xcode-bot .
docker run -p 5000:5000 --env-file .env xcode-bot
```

## Usage

Once configured, X-code automatically reviews PRs:

1. **Open a Pull Request** in your repository
2. **X-code triggers** and analyzes the changes
3. **Review posted** with:
   - Inline comments on specific lines
   - Overall summary
   - Severity breakdown
   - Auto-fix suggestions

### Example Review Comment

```
SECURITY (high)

Potential SQL injection vulnerability detected.

Suggestion: Use parameterized queries instead of string concatenation.

Auto-fix:
```python
cursor.execute("SELECT * FROM users WHERE id = ?", (user_id,))
```

Generated by X-code AI Code Review Assistant
```

## Configuration

Edit `config.py` or use environment variables:

| Variable | Description | Default |
|----------|-------------|---------|
| `GITHUB_TOKEN` | GitHub Personal Access Token | Required |
| `GITHUB_WEBHOOK_SECRET` | Webhook secret for validation | Required |
| `GROQ_API_KEY` | Groq API key | Required |
| `GROQ_MODEL` | Groq model to use | llama-3.3-70b-versatile |
| `MAX_FILES_TO_REVIEW` | Maximum files per PR | 20 |
| `MAX_LINES_PER_FILE` | Maximum lines to analyze | 500 |
| `ENABLE_AUTO_FIX` | Enable auto-fix suggestions | True |

## Available Groq Models

X-code uses **llama-3.3-70b-versatile** by default, which offers:
- 1,000 requests per minute (RPM)
- 500,000 tokens per minute (TPM)
- Excellent code understanding and generation
- Cost-effective alternative to GPT-4

Other available models:
- `llama-3.1-8b-instant` - Faster, lower capacity
- `meta-llama/llama-4-maverick-17b-128e-instruct` - Balanced option
- `qwen/qwen3-32b` - Alternative architecture

## Architecture

```
┌─────────────┐
│   GitHub    │
│  Webhook    │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│   Flask     │
│  Endpoint   │
└──────┬──────┘
       │
       ├──────────────┐
       ▼              ▼
┌─────────────┐  ┌─────────────┐
│   Static    │  │  Groq LLM   │
│  Analysis   │  │  Analysis   │
│             │  │             │
│ • Pylint    │  │ • Llama 3.3 │
│ • Bandit    │  │   70B       │
│ • Radon     │  │             │
└──────┬──────┘  └──────┬──────┘
       │                │
       └────────┬───────┘
                ▼
         ┌─────────────┐
         │   GitHub    │
         │     API     │
         │  (Comment)  │
         └─────────────┘
```

## Testing

Test the webhook locally:

```bash
curl -X POST http://localhost:5000/webhook \
  -H "Content-Type: application/json" \
  -H "X-GitHub-Event: pull_request" \
  -d @test_payload.json
```

## Contributing

Contributions welcome! Please:

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Submit a pull request

## License

MIT License - feel free to use in your projects!

## Links

- **Repository**: https://github.com/abhi3114-glitch/CODEX
- **Issues**: https://github.com/abhi3114-glitch/CODEX/issues
- **Groq Console**: https://console.groq.com
- **Documentation**: [GitHub Webhooks](https://docs.github.com/en/developers/webhooks-and-events/webhooks)

## Tips

- **Rate Limits**: Be aware of GitHub API rate limits (5000 requests/hour)
- **Cost Management**: Groq offers generous free tier limits
- **Security**: Never commit `.env` file with credentials
- **Performance**: Use task queues (Celery) for production
- **Scaling**: Consider serverless (AWS Lambda) for high traffic

## Troubleshooting

### Webhook not triggering
- Check webhook delivery in GitHub settings
- Verify signature validation
- Check server logs

### Analysis failing
- Verify Groq API key
- Check file size limits
- Review error logs

### Comments not posting
- Verify GitHub token permissions
- Check PR number and repository access
- Review GitHub API rate limits

## Why Groq?

- **Fast**: Ultra-low latency inference
- **Cost-Effective**: Generous free tier
- **Powerful**: State-of-the-art open models
- **Reliable**: High uptime and availability
- **Developer-Friendly**: Simple API, great docs

---

**Built with Python, Flask, Groq, and Llama 3.3 70B** #testing2
